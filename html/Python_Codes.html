<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>5dc6d122ad9445d193504d51c6ca1fad</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import all the necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score, recall_score, f1_score, accuracy_score</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;bank_additional_full.csv&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>...</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>poutcome</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>unknown</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>73</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>46</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>56</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>2</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>44</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>74</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>3</td>
      <td>999</td>
      <td>1</td>
      <td>failure</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>41188 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<pre><code>(41188, 21)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 41188 entries, 0 to 41187
Data columns (total 21 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   age             41188 non-null  int64  
 1   job             41188 non-null  object 
 2   marital         41188 non-null  object 
 3   education       41188 non-null  object 
 4   default         41188 non-null  object 
 5   housing         41188 non-null  object 
 6   loan            41188 non-null  object 
 7   contact         41188 non-null  object 
 8   month           41188 non-null  object 
 9   day_of_week     41188 non-null  object 
 10  duration        41188 non-null  int64  
 11  campaign        41188 non-null  int64  
 12  pdays           41188 non-null  int64  
 13  previous        41188 non-null  int64  
 14  poutcome        41188 non-null  object 
 15  emp_var_rate    41188 non-null  float64
 16  cons_price_idx  41188 non-null  float64
 17  cons_conf_idx   41188 non-null  float64
 18  euribor3m       41188 non-null  float64
 19  nr_employed     41188 non-null  float64
 20  y               41188 non-null  bool   
dtypes: bool(1), float64(5), int64(5), object(10)
memory usage: 6.3+ MB
</code></pre>
</div>
</div>
<section id="here-we-can-see-that-there-is-no-null-value" class="cell markdown">
<h6>Here we can see that there is no null value</h6>
</section>
<section id="now-count-the-value-of-each-column-so-we-can-see-that-is-there-any-unkown-value-in-the-column-or-not" class="cell markdown">
<h6>Now, Count the value of each column so we can see that is there any unkown value in the column or not</h6>
</section>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here age column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#age_counts = df[&#39;age&#39;].value_counts()</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(age_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown job column has</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>job_counts <span class="op">=</span> df[<span class="st">&#39;job&#39;</span>].value_counts()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(job_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>admin.           10422
blue-collar       9254
technician        6743
services          3969
management        2924
retired           1720
entrepreneur      1456
self-employed     1421
housemaid         1060
unemployed        1014
student            875
unknown            330
Name: job, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown marital column has</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>marital_counts <span class="op">=</span> df[<span class="st">&#39;marital&#39;</span>].value_counts()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(marital_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>married     24928
single      11568
divorced     4612
unknown        80
Name: marital, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown education column has</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>education_counts <span class="op">=</span> df[<span class="st">&#39;education&#39;</span>].value_counts()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(education_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>university.degree      12168
high.school             9515
basic.9y                6045
professional.course     5243
basic.4y                4176
basic.6y                2292
unknown                 1731
illiterate                18
Name: education, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="10">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown default column has</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>default_counts <span class="op">=</span> df[<span class="st">&#39;default&#39;</span>].value_counts()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(default_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>no         32588
unknown     8597
yes            3
Name: default, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown housing column has</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>housing_counts <span class="op">=</span> df[<span class="st">&#39;housing&#39;</span>].value_counts()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>yes        21576
no         18622
unknown      990
Name: housing, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown loan column has</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>loan_counts <span class="op">=</span> df[<span class="st">&#39;loan&#39;</span>].value_counts()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(loan_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>no         33950
yes         6248
unknown      990
Name: loan, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown contact column has and there is no unown value</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>contact_counts <span class="op">=</span> df[<span class="st">&#39;contact&#39;</span>].value_counts()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(contact_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>cellular     26144
telephone    15044
Name: contact, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown month column has and there is no unown value</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>month_counts <span class="op">=</span> df[<span class="st">&#39;month&#39;</span>].value_counts()</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(month_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>may    13769
jul     7174
aug     6178
jun     5318
nov     4101
apr     2632
oct      718
sep      570
mar      546
dec      182
Name: month, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown day column has and there is no unown value</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>day_of_week_counts <span class="op">=</span> df[<span class="st">&#39;day_of_week&#39;</span>].value_counts()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(day_of_week_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>thu    8623
mon    8514
wed    8134
tue    8090
fri    7827
Name: day_of_week, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here duration column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#duration_counts = df[&#39;duration&#39;].value_counts()</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(duration_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here campaign column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#campaign_counts = df[&#39;campaign&#39;].value_counts()</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(campaign_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here pdays column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pdays_counts = df[&#39;pdays&#39;].value_counts()</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(pdays_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here previous column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#previous_counts = df[&#39;previous&#39;].value_counts()</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(previous_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="20">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown poutcome column has and there is no unown value</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>poutcome_counts <span class="op">=</span> df[<span class="st">&#39;poutcome&#39;</span>].value_counts()</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(poutcome_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>nonexistent    35563
failure         4252
success         1373
Name: poutcome, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="21">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here emp_var_rate column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#emp_var_rate_counts = df[&#39;emp_var_rate&#39;].value_counts()</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(emp_var_rate_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="22">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here cons_price_idx column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#cons_price_idx_counts = df[&#39;cons_price_idx&#39;].value_counts()</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(cons_price_idx_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="23">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here cons_conf_idx column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#cons_conf_idx_counts = df[&#39;cons_conf_idx&#39;].value_counts()</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(cons_conf_idx_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="24">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here euribor3m column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#euribor3m_counts = df[&#39;euribor3m&#39;].value_counts()</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(euribor3m_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="25">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here nr_employed column has all numeric value and using df.info() function we found above that thare is no NaN.</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#nr_employed_counts = df[&#39;nr_employed&#39;].value_counts()</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(nr_employed_counts)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="26">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using value_counts() we can find out that how may unknown y column has and there is no unown value</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>y_counts <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>].value_counts()</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>False    36548
True      4640
Name: y, dtype: int64
</code></pre>
</div>
</div>
<section id="correlation-matrix" class="cell markdown">
<h5>Correlation Matrix</h5>
</section>
<div class="cell code" data-execution_count="27">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df.corr()</span></code></pre></div>
<div class="output execute_result" data-execution_count="27">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>age</th>
      <td>1.000000</td>
      <td>-0.000866</td>
      <td>0.004594</td>
      <td>-0.034369</td>
      <td>0.024365</td>
      <td>-0.000371</td>
      <td>0.000857</td>
      <td>0.129372</td>
      <td>0.010767</td>
      <td>-0.017725</td>
      <td>0.030399</td>
    </tr>
    <tr>
      <th>duration</th>
      <td>-0.000866</td>
      <td>1.000000</td>
      <td>-0.071699</td>
      <td>-0.047577</td>
      <td>0.020640</td>
      <td>-0.027968</td>
      <td>0.005312</td>
      <td>-0.008173</td>
      <td>-0.032897</td>
      <td>-0.044703</td>
      <td>0.405274</td>
    </tr>
    <tr>
      <th>campaign</th>
      <td>0.004594</td>
      <td>-0.071699</td>
      <td>1.000000</td>
      <td>0.052584</td>
      <td>-0.079141</td>
      <td>0.150754</td>
      <td>0.127836</td>
      <td>-0.013733</td>
      <td>0.135133</td>
      <td>0.144095</td>
      <td>-0.066357</td>
    </tr>
    <tr>
      <th>pdays</th>
      <td>-0.034369</td>
      <td>-0.047577</td>
      <td>0.052584</td>
      <td>1.000000</td>
      <td>-0.587514</td>
      <td>0.271004</td>
      <td>0.078889</td>
      <td>-0.091342</td>
      <td>0.296899</td>
      <td>0.372605</td>
      <td>-0.324914</td>
    </tr>
    <tr>
      <th>previous</th>
      <td>0.024365</td>
      <td>0.020640</td>
      <td>-0.079141</td>
      <td>-0.587514</td>
      <td>1.000000</td>
      <td>-0.420489</td>
      <td>-0.203130</td>
      <td>-0.050936</td>
      <td>-0.454494</td>
      <td>-0.501333</td>
      <td>0.230181</td>
    </tr>
    <tr>
      <th>emp_var_rate</th>
      <td>-0.000371</td>
      <td>-0.027968</td>
      <td>0.150754</td>
      <td>0.271004</td>
      <td>-0.420489</td>
      <td>1.000000</td>
      <td>0.775334</td>
      <td>0.196041</td>
      <td>0.972245</td>
      <td>0.906970</td>
      <td>-0.298334</td>
    </tr>
    <tr>
      <th>cons_price_idx</th>
      <td>0.000857</td>
      <td>0.005312</td>
      <td>0.127836</td>
      <td>0.078889</td>
      <td>-0.203130</td>
      <td>0.775334</td>
      <td>1.000000</td>
      <td>0.058986</td>
      <td>0.688230</td>
      <td>0.522034</td>
      <td>-0.136211</td>
    </tr>
    <tr>
      <th>cons_conf_idx</th>
      <td>0.129372</td>
      <td>-0.008173</td>
      <td>-0.013733</td>
      <td>-0.091342</td>
      <td>-0.050936</td>
      <td>0.196041</td>
      <td>0.058986</td>
      <td>1.000000</td>
      <td>0.277686</td>
      <td>0.100513</td>
      <td>0.054878</td>
    </tr>
    <tr>
      <th>euribor3m</th>
      <td>0.010767</td>
      <td>-0.032897</td>
      <td>0.135133</td>
      <td>0.296899</td>
      <td>-0.454494</td>
      <td>0.972245</td>
      <td>0.688230</td>
      <td>0.277686</td>
      <td>1.000000</td>
      <td>0.945154</td>
      <td>-0.307771</td>
    </tr>
    <tr>
      <th>nr_employed</th>
      <td>-0.017725</td>
      <td>-0.044703</td>
      <td>0.144095</td>
      <td>0.372605</td>
      <td>-0.501333</td>
      <td>0.906970</td>
      <td>0.522034</td>
      <td>0.100513</td>
      <td>0.945154</td>
      <td>1.000000</td>
      <td>-0.354678</td>
    </tr>
    <tr>
      <th>y</th>
      <td>0.030399</td>
      <td>0.405274</td>
      <td>-0.066357</td>
      <td>-0.324914</td>
      <td>0.230181</td>
      <td>-0.298334</td>
      <td>-0.136211</td>
      <td>0.054878</td>
      <td>-0.307771</td>
      <td>-0.354678</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="28">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.corr(), annot<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_f62f8e53cbb34ea98c3c181dd83e4f61/428e75c460e90b331f203c75839ec287b6a1f3c0.png" /></p>
</div>
</div>
<section id="here-job-marital-education-default-housing-loan-have-unknown-values-we-will-drop-that-rows-except-default-column-because-it-hase-more-unkown-values" class="cell markdown">
<h5>Here job, marital, education, default, housing, loan have unknown values we will drop that rows except default column because it hase more unkown values</h5>
</section>
<div class="cell code" data-execution_count="29">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df.job <span class="op">!=</span> <span class="st">&#39;unknown&#39;</span>)]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>...</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>poutcome</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>unknown</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>73</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>46</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>56</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>2</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>44</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>74</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>3</td>
      <td>999</td>
      <td>1</td>
      <td>failure</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>40858 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="30">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df.marital <span class="op">!=</span> <span class="st">&#39;unknown&#39;</span>)]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="30">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>...</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>poutcome</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>unknown</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>73</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>46</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>56</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>2</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>44</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>74</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>3</td>
      <td>999</td>
      <td>1</td>
      <td>failure</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>40787 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="31">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df.education <span class="op">!=</span> <span class="st">&#39;unknown&#39;</span>)]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="31">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>...</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>poutcome</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>unknown</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>73</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>46</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>56</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>2</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>44</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>74</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>3</td>
      <td>999</td>
      <td>1</td>
      <td>failure</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>39191 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="32">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df.housing <span class="op">!=</span> <span class="st">&#39;unknown&#39;</span>)]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>...</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>poutcome</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>unknown</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>73</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>46</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>56</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>2</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>44</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>74</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>3</td>
      <td>999</td>
      <td>1</td>
      <td>failure</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="33">
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df.loan <span class="op">!=</span> <span class="st">&#39;unknown&#39;</span>)]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>...</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>poutcome</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>unknown</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>73</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>46</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>56</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>2</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>44</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>74</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>...</td>
      <td>3</td>
      <td>999</td>
      <td>1</td>
      <td>failure</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 21 columns</p>
</div>
</div>
</div>
<section id="for-default-column" class="cell markdown">
<h5>For default column</h5>
</section>
<div class="cell code" data-execution_count="34">
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>default_counts <span class="op">=</span> df[<span class="st">&#39;default&#39;</span>].value_counts()</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(default_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>no         30485
unknown     7757
yes            3
Name: default, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="35">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There is only 3 yes values so we can replace unknown values with no</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;default&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;default&#39;</span>].replace([<span class="st">&#39;unknown&#39;</span>],<span class="st">&#39;no&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="36">
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>default_counts <span class="op">=</span> df[<span class="st">&#39;default&#39;</span>].value_counts()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(default_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>no     38242
yes        3
Name: default, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="37">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">
<pre><code>(38245, 21)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="38">
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">20</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>...</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>poutcome</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>45</td>
      <td>services</td>
      <td>married</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>59</td>
      <td>admin.</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>24</td>
      <td>technician</td>
      <td>single</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>25</td>
      <td>services</td>
      <td>single</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>25</td>
      <td>services</td>
      <td>single</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29</td>
      <td>blue-collar</td>
      <td>single</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>13</th>
      <td>57</td>
      <td>housemaid</td>
      <td>divorced</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>14</th>
      <td>35</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>54</td>
      <td>retired</td>
      <td>married</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>35</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>17</th>
      <td>46</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>50</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>39</td>
      <td>management</td>
      <td>single</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>30</td>
      <td>unemployed</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>55</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>...</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>nonexistent</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>20 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="39">
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">&#39;prince.csv&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="40">
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>y_counts <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>].value_counts()</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>False    33987
True      4258
Name: y, dtype: int64
</code></pre>
</div>
</div>
<section id="normalize-data" class="cell markdown">
<h3>Normalize data</h3>
</section>
<div class="cell code" data-execution_count="41">
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 38245 entries, 0 to 41187
Data columns (total 21 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   age             38245 non-null  int64  
 1   job             38245 non-null  object 
 2   marital         38245 non-null  object 
 3   education       38245 non-null  object 
 4   default         38245 non-null  object 
 5   housing         38245 non-null  object 
 6   loan            38245 non-null  object 
 7   contact         38245 non-null  object 
 8   month           38245 non-null  object 
 9   day_of_week     38245 non-null  object 
 10  duration        38245 non-null  int64  
 11  campaign        38245 non-null  int64  
 12  pdays           38245 non-null  int64  
 13  previous        38245 non-null  int64  
 14  poutcome        38245 non-null  object 
 15  emp_var_rate    38245 non-null  float64
 16  cons_price_idx  38245 non-null  float64
 17  cons_conf_idx   38245 non-null  float64
 18  euribor3m       38245 non-null  float64
 19  nr_employed     38245 non-null  float64
 20  y               38245 non-null  bool   
dtypes: bool(1), float64(5), int64(5), object(10)
memory usage: 6.2+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="42">
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the normalization just remove the columns with string value later on we can add that row</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>temp_df1 <span class="op">=</span> df.drop([<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>, <span class="st">&#39;y&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>temp_df1</span></code></pre></div>
<div class="output execute_result" data-execution_count="42">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56</td>
      <td>261</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57</td>
      <td>149</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>226</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>151</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56</td>
      <td>307</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>1.1</td>
      <td>93.994</td>
      <td>-36.4</td>
      <td>4.857</td>
      <td>5191.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>73</td>
      <td>334</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>46</td>
      <td>383</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>56</td>
      <td>189</td>
      <td>2</td>
      <td>999</td>
      <td>0</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>44</td>
      <td>442</td>
      <td>1</td>
      <td>999</td>
      <td>0</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>74</td>
      <td>239</td>
      <td>3</td>
      <td>999</td>
      <td>1</td>
      <td>-1.1</td>
      <td>94.767</td>
      <td>-50.8</td>
      <td>1.028</td>
      <td>4963.6</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 10 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="43">
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>temp_df2 <span class="op">=</span> df.drop([<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>temp_df2</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>failure</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 11 columns</p>
</div>
</div>
</div>
<section id="min-max" class="cell markdown">
<h4>Min-Max</h4>
</section>
<div class="cell code" data-execution_count="44">
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> preprocessing.MinMaxScaler()</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>names <span class="op">=</span> temp_df1.columns</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> scaler.fit_transform(temp_df1)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>df_MinMax <span class="op">=</span> pd.DataFrame(d, columns<span class="op">=</span>names)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>df_MinMax</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.481481</td>
      <td>0.053070</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.493827</td>
      <td>0.030297</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.246914</td>
      <td>0.045954</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.283951</td>
      <td>0.030704</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.481481</td>
      <td>0.062424</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38240</th>
      <td>0.691358</td>
      <td>0.067914</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>38241</th>
      <td>0.358025</td>
      <td>0.077877</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>38242</th>
      <td>0.481481</td>
      <td>0.038430</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>38243</th>
      <td>0.333333</td>
      <td>0.089874</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>38244</th>
      <td>0.703704</td>
      <td>0.048597</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 10 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="45">
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df_MinMax.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">
<pre><code>(38245, 10)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="46">
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>df_MinMax <span class="op">=</span> pd.concat([df_MinMax, temp_df2.reindex(df_MinMax.index)], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>df_MinMax</span></code></pre></div>
<div class="output execute_result" data-execution_count="46">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.481481</td>
      <td>0.053070</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>...</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.493827</td>
      <td>0.030297</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>...</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.246914</td>
      <td>0.045954</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>...</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.283951</td>
      <td>0.030704</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>...</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.481481</td>
      <td>0.062424</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>...</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38240</th>
      <td>0.691358</td>
      <td>0.067914</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>...</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>True</td>
    </tr>
    <tr>
      <th>38241</th>
      <td>0.358025</td>
      <td>0.077877</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>...</td>
      <td>married</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38242</th>
      <td>0.481481</td>
      <td>0.038430</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>...</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>failure</td>
      <td>True</td>
    </tr>
    <tr>
      <th>38243</th>
      <td>0.333333</td>
      <td>0.089874</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>...</td>
      <td>divorced</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38244</th>
      <td>0.703704</td>
      <td>0.048597</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>...</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 21 columns</p>
</div>
</div>
</div>
<section id="z-score" class="cell markdown">
<h5>Z Score</h5>
</section>
<div class="cell code" data-execution_count="47">
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> zscore</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>names <span class="op">=</span> temp_df1.columns</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>temp_z <span class="op">=</span> zscore(temp_df1)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>df_ZScore <span class="op">=</span> pd.DataFrame(temp_z, columns<span class="op">=</span>names)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>df_ZScore</span></code></pre></div>
<div class="output execute_result" data-execution_count="47">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.568527</td>
      <td>0.010749</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.665715</td>
      <td>-0.420370</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.278042</td>
      <td>-0.123976</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.013522</td>
      <td>-0.412671</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.568527</td>
      <td>0.187815</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>3.220720</td>
      <td>0.291746</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>0.596649</td>
      <td>0.480360</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>1.568527</td>
      <td>-0.266399</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>0.402273</td>
      <td>0.707467</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>3.317908</td>
      <td>-0.073935</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 10 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="48">
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df_ZScore.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="48">
<pre><code>(38245, 10)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="49">
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>df_ZScore <span class="op">=</span> pd.concat([df_ZScore, temp_df2.reindex(df_ZScore.index)], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>df_ZScore</span></code></pre></div>
<div class="output execute_result" data-execution_count="49">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.568527</td>
      <td>0.010749</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>...</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.665715</td>
      <td>-0.420370</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>...</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.278042</td>
      <td>-0.123976</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>...</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.013522</td>
      <td>-0.412671</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>...</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.568527</td>
      <td>0.187815</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>...</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>3.220720</td>
      <td>0.291746</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>...</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>0.596649</td>
      <td>0.480360</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>...</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>1.568527</td>
      <td>-0.266399</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>...</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>0.402273</td>
      <td>0.707467</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>...</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>3.317908</td>
      <td>-0.073935</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>...</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>failure</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="50">
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df_MinMax.to_csv(<span class="st">&#39;df_MinMax.csv&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="51">
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>df_ZScore.to_csv(<span class="st">&#39;df_ZScore.csv&#39;</span>)</span></code></pre></div>
</div>
<section id="random-forest-algo-using-min-max" class="cell markdown">
<h3>Random forest algo. using Min-Max</h3>
</section>
<div class="cell code" data-execution_count="52">
<div class="sourceCode" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_MinMax[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>]]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="52">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.481481</td>
      <td>0.053070</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.493827</td>
      <td>0.030297</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.246914</td>
      <td>0.045954</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.283951</td>
      <td>0.030704</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.481481</td>
      <td>0.062424</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38240</th>
      <td>0.691358</td>
      <td>0.067914</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>management</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38241</th>
      <td>0.358025</td>
      <td>0.077877</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>retired</td>
      <td>married</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38242</th>
      <td>0.481481</td>
      <td>0.038430</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>admin.</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>failure</td>
    </tr>
    <tr>
      <th>38243</th>
      <td>0.333333</td>
      <td>0.089874</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>unemployed</td>
      <td>divorced</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38244</th>
      <td>0.703704</td>
      <td>0.048597</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>management</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="53">
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="output execute_result" data-execution_count="53">
<pre><code>0        False
1        False
2        False
3        False
4        False
         ...  
41183     True
41184    False
41185    False
41186     True
41187    False
Name: y, Length: 38245, dtype: bool</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="54">
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>y_counts <span class="op">=</span> y.value_counts()</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>False    33987
True      4258
Name: y, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="55">
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>x_with_dummies<span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>[<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>], drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>x_with_dummies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 38245 entries, 0 to 38244
Data columns (total 57 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   age                            38245 non-null  float64
 1   duration                       38245 non-null  float64
 2   campaign                       38245 non-null  float64
 3   pdays                          38245 non-null  float64
 4   previous                       38245 non-null  float64
 5   emp_var_rate                   38245 non-null  float64
 6   cons_price_idx                 38245 non-null  float64
 7   cons_conf_idx                  38245 non-null  float64
 8   euribor3m                      38245 non-null  float64
 9   nr_employed                    38245 non-null  float64
 10  job_admin.                     38245 non-null  uint8  
 11  job_blue-collar                38245 non-null  uint8  
 12  job_entrepreneur               38245 non-null  uint8  
 13  job_housemaid                  38245 non-null  uint8  
 14  job_management                 38245 non-null  uint8  
 15  job_retired                    38245 non-null  uint8  
 16  job_self-employed              38245 non-null  uint8  
 17  job_services                   38245 non-null  uint8  
 18  job_student                    38245 non-null  uint8  
 19  job_technician                 38245 non-null  uint8  
 20  job_unemployed                 38245 non-null  uint8  
 21  marital_divorced               38245 non-null  uint8  
 22  marital_married                38245 non-null  uint8  
 23  marital_single                 38245 non-null  uint8  
 24  education_basic.4y             38245 non-null  uint8  
 25  education_basic.6y             38245 non-null  uint8  
 26  education_basic.9y             38245 non-null  uint8  
 27  education_high.school          38245 non-null  uint8  
 28  education_illiterate           38245 non-null  uint8  
 29  education_professional.course  38245 non-null  uint8  
 30  education_university.degree    38245 non-null  uint8  
 31  default_no                     38245 non-null  uint8  
 32  default_yes                    38245 non-null  uint8  
 33  housing_no                     38245 non-null  uint8  
 34  housing_yes                    38245 non-null  uint8  
 35  loan_no                        38245 non-null  uint8  
 36  loan_yes                       38245 non-null  uint8  
 37  contact_cellular               38245 non-null  uint8  
 38  contact_telephone              38245 non-null  uint8  
 39  month_apr                      38245 non-null  uint8  
 40  month_aug                      38245 non-null  uint8  
 41  month_dec                      38245 non-null  uint8  
 42  month_jul                      38245 non-null  uint8  
 43  month_jun                      38245 non-null  uint8  
 44  month_mar                      38245 non-null  uint8  
 45  month_may                      38245 non-null  uint8  
 46  month_nov                      38245 non-null  uint8  
 47  month_oct                      38245 non-null  uint8  
 48  month_sep                      38245 non-null  uint8  
 49  day_of_week_fri                38245 non-null  uint8  
 50  day_of_week_mon                38245 non-null  uint8  
 51  day_of_week_thu                38245 non-null  uint8  
 52  day_of_week_tue                38245 non-null  uint8  
 53  day_of_week_wed                38245 non-null  uint8  
 54  poutcome_failure               38245 non-null  uint8  
 55  poutcome_nonexistent           38245 non-null  uint8  
 56  poutcome_success               38245 non-null  uint8  
dtypes: float64(10), uint8(47)
memory usage: 4.6 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="56">
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_with_dummies, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>x_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="56">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>month_oct</th>
      <th>month_sep</th>
      <th>day_of_week_fri</th>
      <th>day_of_week_mon</th>
      <th>day_of_week_thu</th>
      <th>day_of_week_tue</th>
      <th>day_of_week_wed</th>
      <th>poutcome_failure</th>
      <th>poutcome_nonexistent</th>
      <th>poutcome_success</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23261</th>
      <td>0.271605</td>
      <td>0.074827</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.687500</td>
      <td>0.389322</td>
      <td>0.368201</td>
      <td>0.797778</td>
      <td>0.877883</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>33563</th>
      <td>0.135802</td>
      <td>0.064050</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.333333</td>
      <td>0.269680</td>
      <td>0.192469</td>
      <td>0.142825</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7991</th>
      <td>0.283951</td>
      <td>0.046564</td>
      <td>0.119048</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.882307</td>
      <td>0.376569</td>
      <td>0.958966</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1604</th>
      <td>0.185185</td>
      <td>0.042497</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.602510</td>
      <td>0.956926</td>
      <td>0.859735</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28852</th>
      <td>0.308642</td>
      <td>0.044937</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.285714</td>
      <td>0.333333</td>
      <td>0.269680</td>
      <td>0.192469</td>
      <td>0.160961</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12108</th>
      <td>0.469136</td>
      <td>0.038430</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.669135</td>
      <td>0.338912</td>
      <td>0.981183</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9475</th>
      <td>0.432099</td>
      <td>0.032940</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.882307</td>
      <td>0.376569</td>
      <td>0.980730</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>36482</th>
      <td>0.148148</td>
      <td>0.031314</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.333333</td>
      <td>0.455183</td>
      <td>0.669456</td>
      <td>0.004081</td>
      <td>0.170510</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19709</th>
      <td>0.160494</td>
      <td>0.049614</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.484412</td>
      <td>0.615063</td>
      <td>0.981410</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14155</th>
      <td>0.123457</td>
      <td>0.022367</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.669135</td>
      <td>0.338912</td>
      <td>0.980050</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>26771 rows × 57 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="57">
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">160</span>, criterion<span class="op">=</span><span class="st">&#39;entropy&#39;</span>, random_state <span class="op">=</span> <span class="dv">24</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="57">
<pre><code>RandomForestClassifier(criterion=&#39;entropy&#39;, n_estimators=160, random_state=24)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="58">
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="59">
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># accuracy</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="59">
<pre><code>0.9084016036255883</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="60">
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error rate</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="60">
<pre><code>0.0915983963744117</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="61">
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">
<pre><code>0.6572827417380661</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="62">
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="62">
<pre><code>0.4105504587155963</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="63">
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F1 Score</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="63">
<pre><code>0.5054117647058823</code></pre>
</div>
</div>
<section id="random-forest-algo-using-z-score" class="cell markdown">
<h3>Random forest algo. using Z Score</h3>
</section>
<div class="cell code" data-execution_count="64">
<div class="sourceCode" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_ZScore[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>]]</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="64">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.568527</td>
      <td>0.010749</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.665715</td>
      <td>-0.420370</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.278042</td>
      <td>-0.123976</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.013522</td>
      <td>-0.412671</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.568527</td>
      <td>0.187815</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>3.220720</td>
      <td>0.291746</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>0.596649</td>
      <td>0.480360</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>1.568527</td>
      <td>-0.266399</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>0.402273</td>
      <td>0.707467</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>3.317908</td>
      <td>-0.073935</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>failure</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="65">
<div class="sourceCode" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="output execute_result" data-execution_count="65">
<pre><code>0        False
1        False
2        False
3        False
4        False
         ...  
41183     True
41184    False
41185    False
41186     True
41187    False
Name: y, Length: 38245, dtype: bool</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="66">
<div class="sourceCode" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>x_with_dummies<span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>[<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>], drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>x_with_dummies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 38245 entries, 0 to 41187
Data columns (total 57 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   age                            38245 non-null  float64
 1   duration                       38245 non-null  float64
 2   campaign                       38245 non-null  float64
 3   pdays                          38245 non-null  float64
 4   previous                       38245 non-null  float64
 5   emp_var_rate                   38245 non-null  float64
 6   cons_price_idx                 38245 non-null  float64
 7   cons_conf_idx                  38245 non-null  float64
 8   euribor3m                      38245 non-null  float64
 9   nr_employed                    38245 non-null  float64
 10  job_admin.                     38245 non-null  uint8  
 11  job_blue-collar                38245 non-null  uint8  
 12  job_entrepreneur               38245 non-null  uint8  
 13  job_housemaid                  38245 non-null  uint8  
 14  job_management                 38245 non-null  uint8  
 15  job_retired                    38245 non-null  uint8  
 16  job_self-employed              38245 non-null  uint8  
 17  job_services                   38245 non-null  uint8  
 18  job_student                    38245 non-null  uint8  
 19  job_technician                 38245 non-null  uint8  
 20  job_unemployed                 38245 non-null  uint8  
 21  marital_divorced               38245 non-null  uint8  
 22  marital_married                38245 non-null  uint8  
 23  marital_single                 38245 non-null  uint8  
 24  education_basic.4y             38245 non-null  uint8  
 25  education_basic.6y             38245 non-null  uint8  
 26  education_basic.9y             38245 non-null  uint8  
 27  education_high.school          38245 non-null  uint8  
 28  education_illiterate           38245 non-null  uint8  
 29  education_professional.course  38245 non-null  uint8  
 30  education_university.degree    38245 non-null  uint8  
 31  default_no                     38245 non-null  uint8  
 32  default_yes                    38245 non-null  uint8  
 33  housing_no                     38245 non-null  uint8  
 34  housing_yes                    38245 non-null  uint8  
 35  loan_no                        38245 non-null  uint8  
 36  loan_yes                       38245 non-null  uint8  
 37  contact_cellular               38245 non-null  uint8  
 38  contact_telephone              38245 non-null  uint8  
 39  month_apr                      38245 non-null  uint8  
 40  month_aug                      38245 non-null  uint8  
 41  month_dec                      38245 non-null  uint8  
 42  month_jul                      38245 non-null  uint8  
 43  month_jun                      38245 non-null  uint8  
 44  month_mar                      38245 non-null  uint8  
 45  month_may                      38245 non-null  uint8  
 46  month_nov                      38245 non-null  uint8  
 47  month_oct                      38245 non-null  uint8  
 48  month_sep                      38245 non-null  uint8  
 49  day_of_week_fri                38245 non-null  uint8  
 50  day_of_week_mon                38245 non-null  uint8  
 51  day_of_week_thu                38245 non-null  uint8  
 52  day_of_week_tue                38245 non-null  uint8  
 53  day_of_week_wed                38245 non-null  uint8  
 54  poutcome_failure               38245 non-null  uint8  
 55  poutcome_nonexistent           38245 non-null  uint8  
 56  poutcome_success               38245 non-null  uint8  
dtypes: float64(10), uint8(47)
memory usage: 5.9 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="67">
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_with_dummies, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">41</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>x_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="67">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>month_oct</th>
      <th>month_sep</th>
      <th>day_of_week_fri</th>
      <th>day_of_week_mon</th>
      <th>day_of_week_thu</th>
      <th>day_of_week_tue</th>
      <th>day_of_week_wed</th>
      <th>poutcome_failure</th>
      <th>poutcome_nonexistent</th>
      <th>poutcome_success</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5613</th>
      <td>1.568527</td>
      <td>1.396487</td>
      <td>0.517930</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12167</th>
      <td>0.888212</td>
      <td>-0.524300</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>0.603247</td>
      <td>-0.466963</td>
      <td>0.769680</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1801</th>
      <td>1.082588</td>
      <td>-0.478109</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.711883</td>
      <td>0.328423</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31897</th>
      <td>1.568527</td>
      <td>0.441867</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-1.202396</td>
      <td>-1.175158</td>
      <td>-1.224024</td>
      <td>-1.327184</td>
      <td>-0.952246</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12679</th>
      <td>-0.666793</td>
      <td>0.468812</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>0.603247</td>
      <td>-0.466963</td>
      <td>0.772569</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>29117</th>
      <td>-1.347108</td>
      <td>0.399525</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-1.202396</td>
      <td>-0.859383</td>
      <td>-1.418697</td>
      <td>-1.282103</td>
      <td>-0.952246</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>33916</th>
      <td>-0.569605</td>
      <td>1.762168</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-1.202396</td>
      <td>-1.175158</td>
      <td>-1.224024</td>
      <td>-1.353771</td>
      <td>-0.952246</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22121</th>
      <td>1.082588</td>
      <td>-0.046990</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>-0.219157</td>
      <td>0.960638</td>
      <td>0.774303</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>-0.472417</td>
      <td>0.180117</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.712461</td>
      <td>0.328423</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>37292</th>
      <td>-0.861169</td>
      <td>-0.397274</td>
      <td>-0.204761</td>
      <td>-5.206559</td>
      <td>1.703723</td>
      <td>-1.904856</td>
      <td>-2.375799</td>
      <td>1.977263</td>
      <td>-1.583223</td>
      <td>-1.271368</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>26771 rows × 57 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="68">
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">160</span>, criterion<span class="op">=</span><span class="st">&#39;entropy&#39;</span>, random_state <span class="op">=</span> <span class="dv">24</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="68">
<pre><code>RandomForestClassifier(criterion=&#39;entropy&#39;, n_estimators=160, random_state=24)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="69">
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="70">
<div class="sourceCode" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="70">
<pre><code>0.9145023531462437</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="71">
<div class="sourceCode" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Rate</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="71">
<pre><code>0.08549764685375627</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="72">
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="72">
<pre><code>0.6828978622327792</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="73">
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="73">
<pre><code>0.44608223429014743</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="74">
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F1 Score</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="74">
<pre><code>0.5396527451900516</code></pre>
</div>
</div>
<section id="decision-tree-using-min-max" class="cell markdown">
<h3>Decision Tree using Min-Max</h3>
</section>
<div class="cell code" data-execution_count="75">
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_MinMax[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>]]</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="75">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.481481</td>
      <td>0.053070</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.493827</td>
      <td>0.030297</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.246914</td>
      <td>0.045954</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.283951</td>
      <td>0.030704</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.481481</td>
      <td>0.062424</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38240</th>
      <td>0.691358</td>
      <td>0.067914</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>management</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38241</th>
      <td>0.358025</td>
      <td>0.077877</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>retired</td>
      <td>married</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38242</th>
      <td>0.481481</td>
      <td>0.038430</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>admin.</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>failure</td>
    </tr>
    <tr>
      <th>38243</th>
      <td>0.333333</td>
      <td>0.089874</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>unemployed</td>
      <td>divorced</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38244</th>
      <td>0.703704</td>
      <td>0.048597</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>management</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="76">
<div class="sourceCode" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="output execute_result" data-execution_count="76">
<pre><code>0        False
1        False
2        False
3        False
4        False
         ...  
41183     True
41184    False
41185    False
41186     True
41187    False
Name: y, Length: 38245, dtype: bool</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="77">
<div class="sourceCode" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>x_with_dummies<span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>[<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>], drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>x_with_dummies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 38245 entries, 0 to 38244
Data columns (total 57 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   age                            38245 non-null  float64
 1   duration                       38245 non-null  float64
 2   campaign                       38245 non-null  float64
 3   pdays                          38245 non-null  float64
 4   previous                       38245 non-null  float64
 5   emp_var_rate                   38245 non-null  float64
 6   cons_price_idx                 38245 non-null  float64
 7   cons_conf_idx                  38245 non-null  float64
 8   euribor3m                      38245 non-null  float64
 9   nr_employed                    38245 non-null  float64
 10  job_admin.                     38245 non-null  uint8  
 11  job_blue-collar                38245 non-null  uint8  
 12  job_entrepreneur               38245 non-null  uint8  
 13  job_housemaid                  38245 non-null  uint8  
 14  job_management                 38245 non-null  uint8  
 15  job_retired                    38245 non-null  uint8  
 16  job_self-employed              38245 non-null  uint8  
 17  job_services                   38245 non-null  uint8  
 18  job_student                    38245 non-null  uint8  
 19  job_technician                 38245 non-null  uint8  
 20  job_unemployed                 38245 non-null  uint8  
 21  marital_divorced               38245 non-null  uint8  
 22  marital_married                38245 non-null  uint8  
 23  marital_single                 38245 non-null  uint8  
 24  education_basic.4y             38245 non-null  uint8  
 25  education_basic.6y             38245 non-null  uint8  
 26  education_basic.9y             38245 non-null  uint8  
 27  education_high.school          38245 non-null  uint8  
 28  education_illiterate           38245 non-null  uint8  
 29  education_professional.course  38245 non-null  uint8  
 30  education_university.degree    38245 non-null  uint8  
 31  default_no                     38245 non-null  uint8  
 32  default_yes                    38245 non-null  uint8  
 33  housing_no                     38245 non-null  uint8  
 34  housing_yes                    38245 non-null  uint8  
 35  loan_no                        38245 non-null  uint8  
 36  loan_yes                       38245 non-null  uint8  
 37  contact_cellular               38245 non-null  uint8  
 38  contact_telephone              38245 non-null  uint8  
 39  month_apr                      38245 non-null  uint8  
 40  month_aug                      38245 non-null  uint8  
 41  month_dec                      38245 non-null  uint8  
 42  month_jul                      38245 non-null  uint8  
 43  month_jun                      38245 non-null  uint8  
 44  month_mar                      38245 non-null  uint8  
 45  month_may                      38245 non-null  uint8  
 46  month_nov                      38245 non-null  uint8  
 47  month_oct                      38245 non-null  uint8  
 48  month_sep                      38245 non-null  uint8  
 49  day_of_week_fri                38245 non-null  uint8  
 50  day_of_week_mon                38245 non-null  uint8  
 51  day_of_week_thu                38245 non-null  uint8  
 52  day_of_week_tue                38245 non-null  uint8  
 53  day_of_week_wed                38245 non-null  uint8  
 54  poutcome_failure               38245 non-null  uint8  
 55  poutcome_nonexistent           38245 non-null  uint8  
 56  poutcome_success               38245 non-null  uint8  
dtypes: float64(10), uint8(47)
memory usage: 4.6 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="78">
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_with_dummies, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>x_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="78">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>month_oct</th>
      <th>month_sep</th>
      <th>day_of_week_fri</th>
      <th>day_of_week_mon</th>
      <th>day_of_week_thu</th>
      <th>day_of_week_tue</th>
      <th>day_of_week_wed</th>
      <th>poutcome_failure</th>
      <th>poutcome_nonexistent</th>
      <th>poutcome_success</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15973</th>
      <td>0.259259</td>
      <td>0.064864</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.669135</td>
      <td>0.338912</td>
      <td>0.981183</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>32665</th>
      <td>0.135802</td>
      <td>0.078487</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.333333</td>
      <td>0.269680</td>
      <td>0.192469</td>
      <td>0.139651</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>36390</th>
      <td>0.160494</td>
      <td>0.052054</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.083333</td>
      <td>0.199532</td>
      <td>0.744770</td>
      <td>0.016323</td>
      <td>0.226465</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12549</th>
      <td>0.172840</td>
      <td>0.066694</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.669135</td>
      <td>0.338912</td>
      <td>0.981410</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7212</th>
      <td>0.271605</td>
      <td>0.114477</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.882307</td>
      <td>0.376569</td>
      <td>0.959193</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20757</th>
      <td>0.160494</td>
      <td>0.051647</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.484412</td>
      <td>0.615063</td>
      <td>0.981637</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>32103</th>
      <td>0.185185</td>
      <td>0.064660</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.333333</td>
      <td>0.269680</td>
      <td>0.192469</td>
      <td>0.143278</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>30403</th>
      <td>0.172840</td>
      <td>0.307849</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.333333</td>
      <td>0.269680</td>
      <td>0.192469</td>
      <td>0.150759</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21243</th>
      <td>0.333333</td>
      <td>0.011387</td>
      <td>0.095238</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.484412</td>
      <td>0.615063</td>
      <td>0.981864</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2732</th>
      <td>0.160494</td>
      <td>0.061610</td>
      <td>0.071429</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.602510</td>
      <td>0.957833</td>
      <td>0.859735</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>26771 rows × 57 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="79">
<div class="sourceCode" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="79">
<pre><code>DecisionTreeClassifier()</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="80">
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="81">
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="81">
<pre><code>0.8914066585323339</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="82">
<div class="sourceCode" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Rate</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="82">
<pre><code>0.10859334146766608</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="83">
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="83">
<pre><code>0.49835796387520526</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="84">
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="84">
<pre><code>0.4887278582930757</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="85">
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F1 Score</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="85">
<pre><code>0.49349593495934957</code></pre>
</div>
</div>
<section id="decision-tree-using-z-score" class="cell markdown">
<h3>Decision Tree using Z Score</h3>
</section>
<div class="cell code" data-execution_count="86">
<div class="sourceCode" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_ZScore[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>]]</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="86">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.568527</td>
      <td>0.010749</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.665715</td>
      <td>-0.420370</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.278042</td>
      <td>-0.123976</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.013522</td>
      <td>-0.412671</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.568527</td>
      <td>0.187815</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>3.220720</td>
      <td>0.291746</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>0.596649</td>
      <td>0.480360</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>1.568527</td>
      <td>-0.266399</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>0.402273</td>
      <td>0.707467</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>3.317908</td>
      <td>-0.073935</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>failure</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="87">
<div class="sourceCode" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="output execute_result" data-execution_count="87">
<pre><code>0        False
1        False
2        False
3        False
4        False
         ...  
41183     True
41184    False
41185    False
41186     True
41187    False
Name: y, Length: 38245, dtype: bool</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="88">
<div class="sourceCode" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>x_with_dummies<span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>[<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>], drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>x_with_dummies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 38245 entries, 0 to 41187
Data columns (total 57 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   age                            38245 non-null  float64
 1   duration                       38245 non-null  float64
 2   campaign                       38245 non-null  float64
 3   pdays                          38245 non-null  float64
 4   previous                       38245 non-null  float64
 5   emp_var_rate                   38245 non-null  float64
 6   cons_price_idx                 38245 non-null  float64
 7   cons_conf_idx                  38245 non-null  float64
 8   euribor3m                      38245 non-null  float64
 9   nr_employed                    38245 non-null  float64
 10  job_admin.                     38245 non-null  uint8  
 11  job_blue-collar                38245 non-null  uint8  
 12  job_entrepreneur               38245 non-null  uint8  
 13  job_housemaid                  38245 non-null  uint8  
 14  job_management                 38245 non-null  uint8  
 15  job_retired                    38245 non-null  uint8  
 16  job_self-employed              38245 non-null  uint8  
 17  job_services                   38245 non-null  uint8  
 18  job_student                    38245 non-null  uint8  
 19  job_technician                 38245 non-null  uint8  
 20  job_unemployed                 38245 non-null  uint8  
 21  marital_divorced               38245 non-null  uint8  
 22  marital_married                38245 non-null  uint8  
 23  marital_single                 38245 non-null  uint8  
 24  education_basic.4y             38245 non-null  uint8  
 25  education_basic.6y             38245 non-null  uint8  
 26  education_basic.9y             38245 non-null  uint8  
 27  education_high.school          38245 non-null  uint8  
 28  education_illiterate           38245 non-null  uint8  
 29  education_professional.course  38245 non-null  uint8  
 30  education_university.degree    38245 non-null  uint8  
 31  default_no                     38245 non-null  uint8  
 32  default_yes                    38245 non-null  uint8  
 33  housing_no                     38245 non-null  uint8  
 34  housing_yes                    38245 non-null  uint8  
 35  loan_no                        38245 non-null  uint8  
 36  loan_yes                       38245 non-null  uint8  
 37  contact_cellular               38245 non-null  uint8  
 38  contact_telephone              38245 non-null  uint8  
 39  month_apr                      38245 non-null  uint8  
 40  month_aug                      38245 non-null  uint8  
 41  month_dec                      38245 non-null  uint8  
 42  month_jul                      38245 non-null  uint8  
 43  month_jun                      38245 non-null  uint8  
 44  month_mar                      38245 non-null  uint8  
 45  month_may                      38245 non-null  uint8  
 46  month_nov                      38245 non-null  uint8  
 47  month_oct                      38245 non-null  uint8  
 48  month_sep                      38245 non-null  uint8  
 49  day_of_week_fri                38245 non-null  uint8  
 50  day_of_week_mon                38245 non-null  uint8  
 51  day_of_week_thu                38245 non-null  uint8  
 52  day_of_week_tue                38245 non-null  uint8  
 53  day_of_week_wed                38245 non-null  uint8  
 54  poutcome_failure               38245 non-null  uint8  
 55  poutcome_nonexistent           38245 non-null  uint8  
 56  poutcome_success               38245 non-null  uint8  
dtypes: float64(10), uint8(47)
memory usage: 5.9 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="89">
<div class="sourceCode" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_with_dummies, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>x_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="89">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>month_oct</th>
      <th>month_sep</th>
      <th>day_of_week_fri</th>
      <th>day_of_week_mon</th>
      <th>day_of_week_thu</th>
      <th>day_of_week_tue</th>
      <th>day_of_week_wed</th>
      <th>poutcome_failure</th>
      <th>poutcome_nonexistent</th>
      <th>poutcome_success</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>38948</th>
      <td>-0.180854</td>
      <td>-0.570492</td>
      <td>0.156584</td>
      <td>-5.195707</td>
      <td>1.703723</td>
      <td>-2.224156</td>
      <td>-1.598505</td>
      <td>2.258457</td>
      <td>-1.678588</td>
      <td>-2.089379</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20066</th>
      <td>-0.569605</td>
      <td>-0.158619</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>-0.219157</td>
      <td>0.960638</td>
      <td>0.775459</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>37217</th>
      <td>-0.763981</td>
      <td>-0.489657</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-1.904856</td>
      <td>-2.375799</td>
      <td>1.977263</td>
      <td>-1.584957</td>
      <td>-1.271368</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>41087</th>
      <td>-0.958357</td>
      <td>-0.566642</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.487859</td>
      <td>-2.840500</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19052</th>
      <td>-0.569605</td>
      <td>-0.620532</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>-0.219157</td>
      <td>0.960638</td>
      <td>0.777193</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9362</th>
      <td>-1.152732</td>
      <td>-0.558944</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>1.552308</td>
      <td>-0.272290</td>
      <td>0.776615</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>37444</th>
      <td>-0.763981</td>
      <td>-0.824544</td>
      <td>-0.566106</td>
      <td>-5.211986</td>
      <td>1.703723</td>
      <td>-1.904856</td>
      <td>-2.375799</td>
      <td>1.977263</td>
      <td>-1.586113</td>
      <td>-1.271368</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>34351</th>
      <td>0.013522</td>
      <td>0.803699</td>
      <td>1.240620</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-1.202396</td>
      <td>-1.175158</td>
      <td>-1.224024</td>
      <td>-1.362440</td>
      <td>-0.952246</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24455</th>
      <td>-0.180854</td>
      <td>-0.020045</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-0.116775</td>
      <td>-0.642504</td>
      <td>-0.315551</td>
      <td>0.328113</td>
      <td>0.395313</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15240</th>
      <td>0.596649</td>
      <td>-0.566642</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>0.603247</td>
      <td>-0.466963</td>
      <td>0.771413</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>26771 rows × 57 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="90">
<div class="sourceCode" id="cb138"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="90">
<pre><code>DecisionTreeClassifier()</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="91">
<div class="sourceCode" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="92">
<div class="sourceCode" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="92">
<pre><code>0.8920167334843995</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="93">
<div class="sourceCode" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Rate</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="93">
<pre><code>0.10798326651560053</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="94">
<div class="sourceCode" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="94">
<pre><code>0.4972462627852085</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="95">
<div class="sourceCode" id="cb147"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="95">
<pre><code>0.512987012987013</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="96">
<div class="sourceCode" id="cb149"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F1 Score</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="96">
<pre><code>0.5049940071913704</code></pre>
</div>
</div>
<section id="naive-bayes-using-min-max" class="cell markdown">
<h3>Naive Bayes Using Min-Max</h3>
</section>
<div class="cell code" data-execution_count="97">
<div class="sourceCode" id="cb151"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_MinMax[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>]]</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="97">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.481481</td>
      <td>0.053070</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.493827</td>
      <td>0.030297</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.246914</td>
      <td>0.045954</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.283951</td>
      <td>0.030704</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.481481</td>
      <td>0.062424</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38240</th>
      <td>0.691358</td>
      <td>0.067914</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>management</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38241</th>
      <td>0.358025</td>
      <td>0.077877</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>retired</td>
      <td>married</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38242</th>
      <td>0.481481</td>
      <td>0.038430</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>admin.</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>failure</td>
    </tr>
    <tr>
      <th>38243</th>
      <td>0.333333</td>
      <td>0.089874</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>unemployed</td>
      <td>divorced</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38244</th>
      <td>0.703704</td>
      <td>0.048597</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>management</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="98">
<div class="sourceCode" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="output execute_result" data-execution_count="98">
<pre><code>0        False
1        False
2        False
3        False
4        False
         ...  
41183     True
41184    False
41185    False
41186     True
41187    False
Name: y, Length: 38245, dtype: bool</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="99">
<div class="sourceCode" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>x_with_dummies<span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>[<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>], drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>x_with_dummies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 38245 entries, 0 to 38244
Data columns (total 57 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   age                            38245 non-null  float64
 1   duration                       38245 non-null  float64
 2   campaign                       38245 non-null  float64
 3   pdays                          38245 non-null  float64
 4   previous                       38245 non-null  float64
 5   emp_var_rate                   38245 non-null  float64
 6   cons_price_idx                 38245 non-null  float64
 7   cons_conf_idx                  38245 non-null  float64
 8   euribor3m                      38245 non-null  float64
 9   nr_employed                    38245 non-null  float64
 10  job_admin.                     38245 non-null  uint8  
 11  job_blue-collar                38245 non-null  uint8  
 12  job_entrepreneur               38245 non-null  uint8  
 13  job_housemaid                  38245 non-null  uint8  
 14  job_management                 38245 non-null  uint8  
 15  job_retired                    38245 non-null  uint8  
 16  job_self-employed              38245 non-null  uint8  
 17  job_services                   38245 non-null  uint8  
 18  job_student                    38245 non-null  uint8  
 19  job_technician                 38245 non-null  uint8  
 20  job_unemployed                 38245 non-null  uint8  
 21  marital_divorced               38245 non-null  uint8  
 22  marital_married                38245 non-null  uint8  
 23  marital_single                 38245 non-null  uint8  
 24  education_basic.4y             38245 non-null  uint8  
 25  education_basic.6y             38245 non-null  uint8  
 26  education_basic.9y             38245 non-null  uint8  
 27  education_high.school          38245 non-null  uint8  
 28  education_illiterate           38245 non-null  uint8  
 29  education_professional.course  38245 non-null  uint8  
 30  education_university.degree    38245 non-null  uint8  
 31  default_no                     38245 non-null  uint8  
 32  default_yes                    38245 non-null  uint8  
 33  housing_no                     38245 non-null  uint8  
 34  housing_yes                    38245 non-null  uint8  
 35  loan_no                        38245 non-null  uint8  
 36  loan_yes                       38245 non-null  uint8  
 37  contact_cellular               38245 non-null  uint8  
 38  contact_telephone              38245 non-null  uint8  
 39  month_apr                      38245 non-null  uint8  
 40  month_aug                      38245 non-null  uint8  
 41  month_dec                      38245 non-null  uint8  
 42  month_jul                      38245 non-null  uint8  
 43  month_jun                      38245 non-null  uint8  
 44  month_mar                      38245 non-null  uint8  
 45  month_may                      38245 non-null  uint8  
 46  month_nov                      38245 non-null  uint8  
 47  month_oct                      38245 non-null  uint8  
 48  month_sep                      38245 non-null  uint8  
 49  day_of_week_fri                38245 non-null  uint8  
 50  day_of_week_mon                38245 non-null  uint8  
 51  day_of_week_thu                38245 non-null  uint8  
 52  day_of_week_tue                38245 non-null  uint8  
 53  day_of_week_wed                38245 non-null  uint8  
 54  poutcome_failure               38245 non-null  uint8  
 55  poutcome_nonexistent           38245 non-null  uint8  
 56  poutcome_success               38245 non-null  uint8  
dtypes: float64(10), uint8(47)
memory usage: 4.6 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="100">
<div class="sourceCode" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_with_dummies, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>x_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="100">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>month_oct</th>
      <th>month_sep</th>
      <th>day_of_week_fri</th>
      <th>day_of_week_mon</th>
      <th>day_of_week_thu</th>
      <th>day_of_week_tue</th>
      <th>day_of_week_wed</th>
      <th>poutcome_failure</th>
      <th>poutcome_nonexistent</th>
      <th>poutcome_success</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26184</th>
      <td>0.308642</td>
      <td>0.089671</td>
      <td>0.071429</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.333333</td>
      <td>0.340608</td>
      <td>0.154812</td>
      <td>0.188619</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1397</th>
      <td>0.308642</td>
      <td>0.032534</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.602510</td>
      <td>0.956926</td>
      <td>0.859735</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9485</th>
      <td>0.086420</td>
      <td>0.054087</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.882307</td>
      <td>0.376569</td>
      <td>0.980730</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21366</th>
      <td>0.246914</td>
      <td>0.017283</td>
      <td>0.261905</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.484412</td>
      <td>0.615063</td>
      <td>0.981864</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22022</th>
      <td>0.197531</td>
      <td>0.032940</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.484412</td>
      <td>0.615063</td>
      <td>0.981410</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23346</th>
      <td>0.271605</td>
      <td>0.044530</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.687500</td>
      <td>0.389322</td>
      <td>0.368201</td>
      <td>0.797778</td>
      <td>0.877883</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11863</th>
      <td>0.222222</td>
      <td>0.031924</td>
      <td>0.166667</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.669135</td>
      <td>0.338912</td>
      <td>0.981183</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>27063</th>
      <td>0.197531</td>
      <td>0.082147</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.333333</td>
      <td>0.340608</td>
      <td>0.154812</td>
      <td>0.174790</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8366</th>
      <td>0.407407</td>
      <td>0.084181</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.882307</td>
      <td>0.376569</td>
      <td>0.982317</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17530</th>
      <td>0.209877</td>
      <td>0.021147</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.484412</td>
      <td>0.615063</td>
      <td>0.982544</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>26771 rows × 57 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="101">
<div class="sourceCode" id="cb157"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GaussianNB()</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="101">
<pre><code>GaussianNB()</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="102">
<div class="sourceCode" id="cb159"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="103">
<div class="sourceCode" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># accuracy</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="103">
<pre><code>0.8799023880076695</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="104">
<div class="sourceCode" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Rate</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="104">
<pre><code>0.12009761199233049</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="105">
<div class="sourceCode" id="cb164"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="105">
<pre><code>0.4463705308775731</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="106">
<div class="sourceCode" id="cb166"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="106">
<pre><code>0.32212666145426117</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="107">
<div class="sourceCode" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F1 Score</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="107">
<pre><code>0.374205267938238</code></pre>
</div>
</div>
<section id="naive-bayes-using-z-score" class="cell markdown">
<h3>Naive Bayes Using Z Score</h3>
</section>
<div class="cell code" data-execution_count="108">
<div class="sourceCode" id="cb170"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_ZScore[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>]]</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="108">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.568527</td>
      <td>0.010749</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.665715</td>
      <td>-0.420370</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.278042</td>
      <td>-0.123976</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.013522</td>
      <td>-0.412671</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.568527</td>
      <td>0.187815</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>3.220720</td>
      <td>0.291746</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>0.596649</td>
      <td>0.480360</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>1.568527</td>
      <td>-0.266399</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>0.402273</td>
      <td>0.707467</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>3.317908</td>
      <td>-0.073935</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>failure</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="109">
<div class="sourceCode" id="cb171"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="output execute_result" data-execution_count="109">
<pre><code>0        False
1        False
2        False
3        False
4        False
         ...  
41183     True
41184    False
41185    False
41186     True
41187    False
Name: y, Length: 38245, dtype: bool</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="110">
<div class="sourceCode" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>x_with_dummies<span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>[<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>], drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>x_with_dummies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 38245 entries, 0 to 41187
Data columns (total 57 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   age                            38245 non-null  float64
 1   duration                       38245 non-null  float64
 2   campaign                       38245 non-null  float64
 3   pdays                          38245 non-null  float64
 4   previous                       38245 non-null  float64
 5   emp_var_rate                   38245 non-null  float64
 6   cons_price_idx                 38245 non-null  float64
 7   cons_conf_idx                  38245 non-null  float64
 8   euribor3m                      38245 non-null  float64
 9   nr_employed                    38245 non-null  float64
 10  job_admin.                     38245 non-null  uint8  
 11  job_blue-collar                38245 non-null  uint8  
 12  job_entrepreneur               38245 non-null  uint8  
 13  job_housemaid                  38245 non-null  uint8  
 14  job_management                 38245 non-null  uint8  
 15  job_retired                    38245 non-null  uint8  
 16  job_self-employed              38245 non-null  uint8  
 17  job_services                   38245 non-null  uint8  
 18  job_student                    38245 non-null  uint8  
 19  job_technician                 38245 non-null  uint8  
 20  job_unemployed                 38245 non-null  uint8  
 21  marital_divorced               38245 non-null  uint8  
 22  marital_married                38245 non-null  uint8  
 23  marital_single                 38245 non-null  uint8  
 24  education_basic.4y             38245 non-null  uint8  
 25  education_basic.6y             38245 non-null  uint8  
 26  education_basic.9y             38245 non-null  uint8  
 27  education_high.school          38245 non-null  uint8  
 28  education_illiterate           38245 non-null  uint8  
 29  education_professional.course  38245 non-null  uint8  
 30  education_university.degree    38245 non-null  uint8  
 31  default_no                     38245 non-null  uint8  
 32  default_yes                    38245 non-null  uint8  
 33  housing_no                     38245 non-null  uint8  
 34  housing_yes                    38245 non-null  uint8  
 35  loan_no                        38245 non-null  uint8  
 36  loan_yes                       38245 non-null  uint8  
 37  contact_cellular               38245 non-null  uint8  
 38  contact_telephone              38245 non-null  uint8  
 39  month_apr                      38245 non-null  uint8  
 40  month_aug                      38245 non-null  uint8  
 41  month_dec                      38245 non-null  uint8  
 42  month_jul                      38245 non-null  uint8  
 43  month_jun                      38245 non-null  uint8  
 44  month_mar                      38245 non-null  uint8  
 45  month_may                      38245 non-null  uint8  
 46  month_nov                      38245 non-null  uint8  
 47  month_oct                      38245 non-null  uint8  
 48  month_sep                      38245 non-null  uint8  
 49  day_of_week_fri                38245 non-null  uint8  
 50  day_of_week_mon                38245 non-null  uint8  
 51  day_of_week_thu                38245 non-null  uint8  
 52  day_of_week_tue                38245 non-null  uint8  
 53  day_of_week_wed                38245 non-null  uint8  
 54  poutcome_failure               38245 non-null  uint8  
 55  poutcome_nonexistent           38245 non-null  uint8  
 56  poutcome_success               38245 non-null  uint8  
dtypes: float64(10), uint8(47)
memory usage: 5.9 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="111">
<div class="sourceCode" id="cb175"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_with_dummies, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">46</span>)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>x_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="111">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>month_oct</th>
      <th>month_sep</th>
      <th>day_of_week_fri</th>
      <th>day_of_week_mon</th>
      <th>day_of_week_thu</th>
      <th>day_of_week_tue</th>
      <th>day_of_week_wed</th>
      <th>poutcome_failure</th>
      <th>poutcome_nonexistent</th>
      <th>poutcome_success</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12193</th>
      <td>1.276964</td>
      <td>0.187815</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>0.603247</td>
      <td>-0.466963</td>
      <td>0.769680</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26360</th>
      <td>-0.958357</td>
      <td>-0.389576</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.116775</td>
      <td>-0.642504</td>
      <td>-0.315551</td>
      <td>0.261647</td>
      <td>0.395313</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22247</th>
      <td>1.568527</td>
      <td>-0.316440</td>
      <td>1.601965</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>-0.219157</td>
      <td>0.960638</td>
      <td>0.774303</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>40992</th>
      <td>0.791024</td>
      <td>0.303294</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>1.788272</td>
      <td>-1.937825</td>
      <td>-1.511556</td>
      <td>-2.840500</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>33513</th>
      <td>-0.666793</td>
      <td>0.029995</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-1.202396</td>
      <td>-1.175158</td>
      <td>-1.224024</td>
      <td>-1.347991</td>
      <td>-0.952246</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>18563</th>
      <td>0.402273</td>
      <td>0.087734</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>0.603247</td>
      <td>-0.466963</td>
      <td>0.777193</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20483</th>
      <td>1.276964</td>
      <td>3.367316</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>-0.219157</td>
      <td>0.960638</td>
      <td>0.776037</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>32504</th>
      <td>-0.472417</td>
      <td>1.877647</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-1.202396</td>
      <td>-1.175158</td>
      <td>-1.224024</td>
      <td>-1.335276</td>
      <td>-0.952246</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25216</th>
      <td>1.276964</td>
      <td>-0.431918</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-0.116775</td>
      <td>-0.642504</td>
      <td>-0.315551</td>
      <td>0.306150</td>
      <td>0.395313</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16925</th>
      <td>0.693837</td>
      <td>-0.428068</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>0.603247</td>
      <td>-0.466963</td>
      <td>0.773725</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>26771 rows × 57 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="112">
<div class="sourceCode" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GaussianNB()</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="112">
<pre><code>GaussianNB()</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="113">
<div class="sourceCode" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="114">
<div class="sourceCode" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># accuracy</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="114">
<pre><code>0.7103887048980303</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="115">
<div class="sourceCode" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Rate</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="115">
<pre><code>0.2896112951019697</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="116">
<div class="sourceCode" id="cb183"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="116">
<pre><code>0.25516578567996157</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="117">
<div class="sourceCode" id="cb185"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="117">
<pre><code>0.8264591439688715</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="118">
<div class="sourceCode" id="cb187"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F1 Score</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="118">
<pre><code>0.38993941619239947</code></pre>
</div>
</div>
<section id="knn-using-min-max" class="cell markdown">
<h3>KNN Using Min-Max</h3>
</section>
<div class="cell code" data-execution_count="119">
<div class="sourceCode" id="cb189"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_MinMax[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>]]</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="119">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.481481</td>
      <td>0.053070</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.493827</td>
      <td>0.030297</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.246914</td>
      <td>0.045954</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.283951</td>
      <td>0.030704</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.481481</td>
      <td>0.062424</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.60251</td>
      <td>0.957379</td>
      <td>0.859735</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38240</th>
      <td>0.691358</td>
      <td>0.067914</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>management</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38241</th>
      <td>0.358025</td>
      <td>0.077877</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>retired</td>
      <td>married</td>
      <td>basic.9y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38242</th>
      <td>0.481481</td>
      <td>0.038430</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>admin.</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>failure</td>
    </tr>
    <tr>
      <th>38243</th>
      <td>0.333333</td>
      <td>0.089874</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>unemployed</td>
      <td>divorced</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>38244</th>
      <td>0.703704</td>
      <td>0.048597</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.142857</td>
      <td>0.479167</td>
      <td>1.000000</td>
      <td>0.00000</td>
      <td>0.089322</td>
      <td>0.000000</td>
      <td>management</td>
      <td>single</td>
      <td>university.degree</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>oct</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="120">
<div class="sourceCode" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="output execute_result" data-execution_count="120">
<pre><code>0        False
1        False
2        False
3        False
4        False
         ...  
41183     True
41184    False
41185    False
41186     True
41187    False
Name: y, Length: 38245, dtype: bool</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="121">
<div class="sourceCode" id="cb192"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>x_with_dummies<span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>[<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>], drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>x_with_dummies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 38245 entries, 0 to 38244
Data columns (total 57 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   age                            38245 non-null  float64
 1   duration                       38245 non-null  float64
 2   campaign                       38245 non-null  float64
 3   pdays                          38245 non-null  float64
 4   previous                       38245 non-null  float64
 5   emp_var_rate                   38245 non-null  float64
 6   cons_price_idx                 38245 non-null  float64
 7   cons_conf_idx                  38245 non-null  float64
 8   euribor3m                      38245 non-null  float64
 9   nr_employed                    38245 non-null  float64
 10  job_admin.                     38245 non-null  uint8  
 11  job_blue-collar                38245 non-null  uint8  
 12  job_entrepreneur               38245 non-null  uint8  
 13  job_housemaid                  38245 non-null  uint8  
 14  job_management                 38245 non-null  uint8  
 15  job_retired                    38245 non-null  uint8  
 16  job_self-employed              38245 non-null  uint8  
 17  job_services                   38245 non-null  uint8  
 18  job_student                    38245 non-null  uint8  
 19  job_technician                 38245 non-null  uint8  
 20  job_unemployed                 38245 non-null  uint8  
 21  marital_divorced               38245 non-null  uint8  
 22  marital_married                38245 non-null  uint8  
 23  marital_single                 38245 non-null  uint8  
 24  education_basic.4y             38245 non-null  uint8  
 25  education_basic.6y             38245 non-null  uint8  
 26  education_basic.9y             38245 non-null  uint8  
 27  education_high.school          38245 non-null  uint8  
 28  education_illiterate           38245 non-null  uint8  
 29  education_professional.course  38245 non-null  uint8  
 30  education_university.degree    38245 non-null  uint8  
 31  default_no                     38245 non-null  uint8  
 32  default_yes                    38245 non-null  uint8  
 33  housing_no                     38245 non-null  uint8  
 34  housing_yes                    38245 non-null  uint8  
 35  loan_no                        38245 non-null  uint8  
 36  loan_yes                       38245 non-null  uint8  
 37  contact_cellular               38245 non-null  uint8  
 38  contact_telephone              38245 non-null  uint8  
 39  month_apr                      38245 non-null  uint8  
 40  month_aug                      38245 non-null  uint8  
 41  month_dec                      38245 non-null  uint8  
 42  month_jul                      38245 non-null  uint8  
 43  month_jun                      38245 non-null  uint8  
 44  month_mar                      38245 non-null  uint8  
 45  month_may                      38245 non-null  uint8  
 46  month_nov                      38245 non-null  uint8  
 47  month_oct                      38245 non-null  uint8  
 48  month_sep                      38245 non-null  uint8  
 49  day_of_week_fri                38245 non-null  uint8  
 50  day_of_week_mon                38245 non-null  uint8  
 51  day_of_week_thu                38245 non-null  uint8  
 52  day_of_week_tue                38245 non-null  uint8  
 53  day_of_week_wed                38245 non-null  uint8  
 54  poutcome_failure               38245 non-null  uint8  
 55  poutcome_nonexistent           38245 non-null  uint8  
 56  poutcome_success               38245 non-null  uint8  
dtypes: float64(10), uint8(47)
memory usage: 4.6 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="122">
<div class="sourceCode" id="cb194"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_with_dummies, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">48</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>x_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="122">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>month_oct</th>
      <th>month_sep</th>
      <th>day_of_week_fri</th>
      <th>day_of_week_mon</th>
      <th>day_of_week_thu</th>
      <th>day_of_week_tue</th>
      <th>day_of_week_wed</th>
      <th>poutcome_failure</th>
      <th>poutcome_nonexistent</th>
      <th>poutcome_success</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8528</th>
      <td>0.185185</td>
      <td>0.004880</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.882307</td>
      <td>0.376569</td>
      <td>0.982317</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1682</th>
      <td>0.320988</td>
      <td>0.030500</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.602510</td>
      <td>0.956926</td>
      <td>0.859735</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24093</th>
      <td>0.481481</td>
      <td>0.257218</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.687500</td>
      <td>0.389322</td>
      <td>0.368201</td>
      <td>0.790297</td>
      <td>0.877883</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>37342</th>
      <td>0.123457</td>
      <td>0.001423</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.354167</td>
      <td>0.784879</td>
      <td>0.439331</td>
      <td>0.051462</td>
      <td>0.105860</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26290</th>
      <td>0.098765</td>
      <td>0.019723</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.333333</td>
      <td>0.340608</td>
      <td>0.154812</td>
      <td>0.183859</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23472</th>
      <td>0.308642</td>
      <td>0.119154</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.687500</td>
      <td>0.389322</td>
      <td>0.368201</td>
      <td>0.797778</td>
      <td>0.877883</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>30148</th>
      <td>0.456790</td>
      <td>0.015250</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.333333</td>
      <td>0.269680</td>
      <td>0.192469</td>
      <td>0.153933</td>
      <td>0.512287</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9553</th>
      <td>0.382716</td>
      <td>0.024197</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.882307</td>
      <td>0.376569</td>
      <td>0.980730</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2611</th>
      <td>0.172840</td>
      <td>0.051037</td>
      <td>0.023810</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.937500</td>
      <td>0.698753</td>
      <td>0.602510</td>
      <td>0.957833</td>
      <td>0.859735</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15872</th>
      <td>0.308642</td>
      <td>0.025620</td>
      <td>0.047619</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.669135</td>
      <td>0.338912</td>
      <td>0.981183</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>26771 rows × 57 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="123">
<div class="sourceCode" id="cb195"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="123">
<pre><code>KNeighborsClassifier(n_neighbors=3)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="124">
<div class="sourceCode" id="cb197"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="125">
<div class="sourceCode" id="cb198"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># accuracy</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="125">
<pre><code>0.8857416768345825</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="126">
<div class="sourceCode" id="cb200"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Rate</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="126">
<pre><code>0.11425832316541751</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="127">
<div class="sourceCode" id="cb202"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="127">
<pre><code>0.45878136200716846</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="128">
<div class="sourceCode" id="cb204"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="128">
<pre><code>0.20237154150197628</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="129">
<div class="sourceCode" id="cb206"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F1 Score</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="129">
<pre><code>0.2808557323093801</code></pre>
</div>
</div>
<section id="knn-using-z-score" class="cell markdown">
<h3>KNN Using Z Score</h3>
</section>
<div class="cell code" data-execution_count="130">
<div class="sourceCode" id="cb208"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_ZScore[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;duration&#39;</span>, <span class="st">&#39;campaign&#39;</span>, <span class="st">&#39;pdays&#39;</span>, <span class="st">&#39;previous&#39;</span>, <span class="st">&#39;emp_var_rate&#39;</span>, <span class="st">&#39;cons_price_idx&#39;</span>, <span class="st">&#39;cons_conf_idx&#39;</span>, <span class="st">&#39;euribor3m&#39;</span>, <span class="st">&#39;nr_employed&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>]]</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<div class="output execute_result" data-execution_count="130">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>job</th>
      <th>marital</th>
      <th>education</th>
      <th>default</th>
      <th>housing</th>
      <th>loan</th>
      <th>contact</th>
      <th>month</th>
      <th>day_of_week</th>
      <th>poutcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.568527</td>
      <td>0.010749</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>housemaid</td>
      <td>married</td>
      <td>basic.4y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.665715</td>
      <td>-0.420370</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.278042</td>
      <td>-0.123976</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.013522</td>
      <td>-0.412671</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>admin.</td>
      <td>married</td>
      <td>basic.6y</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.568527</td>
      <td>0.187815</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.713039</td>
      <td>0.328423</td>
      <td>services</td>
      <td>married</td>
      <td>high.school</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>telephone</td>
      <td>may</td>
      <td>mon</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41183</th>
      <td>3.220720</td>
      <td>0.291746</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41184</th>
      <td>0.596649</td>
      <td>0.480360</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>blue-collar</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41185</th>
      <td>1.568527</td>
      <td>-0.266399</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>university.degree</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41186</th>
      <td>0.402273</td>
      <td>0.707467</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>technician</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>no</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>nonexistent</td>
    </tr>
    <tr>
      <th>41187</th>
      <td>3.317908</td>
      <td>-0.073935</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>1.703723</td>
      <td>-0.755375</td>
      <td>2.076287</td>
      <td>-2.219019</td>
      <td>-1.499996</td>
      <td>-2.840500</td>
      <td>retired</td>
      <td>married</td>
      <td>professional.course</td>
      <td>no</td>
      <td>yes</td>
      <td>no</td>
      <td>cellular</td>
      <td>nov</td>
      <td>fri</td>
      <td>failure</td>
    </tr>
  </tbody>
</table>
<p>38245 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="131">
<div class="sourceCode" id="cb209"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;y&#39;</span>]</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<div class="output execute_result" data-execution_count="131">
<pre><code>0        False
1        False
2        False
3        False
4        False
         ...  
41183     True
41184    False
41185    False
41186     True
41187    False
Name: y, Length: 38245, dtype: bool</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="132">
<div class="sourceCode" id="cb211"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>x_with_dummies<span class="op">=</span> pd.get_dummies(x, columns<span class="op">=</span>[<span class="st">&#39;job&#39;</span>, <span class="st">&#39;marital&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;default&#39;</span>, <span class="st">&#39;housing&#39;</span>, <span class="st">&#39;loan&#39;</span>, <span class="st">&#39;contact&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;poutcome&#39;</span>], drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>x_with_dummies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 38245 entries, 0 to 41187
Data columns (total 57 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   age                            38245 non-null  float64
 1   duration                       38245 non-null  float64
 2   campaign                       38245 non-null  float64
 3   pdays                          38245 non-null  float64
 4   previous                       38245 non-null  float64
 5   emp_var_rate                   38245 non-null  float64
 6   cons_price_idx                 38245 non-null  float64
 7   cons_conf_idx                  38245 non-null  float64
 8   euribor3m                      38245 non-null  float64
 9   nr_employed                    38245 non-null  float64
 10  job_admin.                     38245 non-null  uint8  
 11  job_blue-collar                38245 non-null  uint8  
 12  job_entrepreneur               38245 non-null  uint8  
 13  job_housemaid                  38245 non-null  uint8  
 14  job_management                 38245 non-null  uint8  
 15  job_retired                    38245 non-null  uint8  
 16  job_self-employed              38245 non-null  uint8  
 17  job_services                   38245 non-null  uint8  
 18  job_student                    38245 non-null  uint8  
 19  job_technician                 38245 non-null  uint8  
 20  job_unemployed                 38245 non-null  uint8  
 21  marital_divorced               38245 non-null  uint8  
 22  marital_married                38245 non-null  uint8  
 23  marital_single                 38245 non-null  uint8  
 24  education_basic.4y             38245 non-null  uint8  
 25  education_basic.6y             38245 non-null  uint8  
 26  education_basic.9y             38245 non-null  uint8  
 27  education_high.school          38245 non-null  uint8  
 28  education_illiterate           38245 non-null  uint8  
 29  education_professional.course  38245 non-null  uint8  
 30  education_university.degree    38245 non-null  uint8  
 31  default_no                     38245 non-null  uint8  
 32  default_yes                    38245 non-null  uint8  
 33  housing_no                     38245 non-null  uint8  
 34  housing_yes                    38245 non-null  uint8  
 35  loan_no                        38245 non-null  uint8  
 36  loan_yes                       38245 non-null  uint8  
 37  contact_cellular               38245 non-null  uint8  
 38  contact_telephone              38245 non-null  uint8  
 39  month_apr                      38245 non-null  uint8  
 40  month_aug                      38245 non-null  uint8  
 41  month_dec                      38245 non-null  uint8  
 42  month_jul                      38245 non-null  uint8  
 43  month_jun                      38245 non-null  uint8  
 44  month_mar                      38245 non-null  uint8  
 45  month_may                      38245 non-null  uint8  
 46  month_nov                      38245 non-null  uint8  
 47  month_oct                      38245 non-null  uint8  
 48  month_sep                      38245 non-null  uint8  
 49  day_of_week_fri                38245 non-null  uint8  
 50  day_of_week_mon                38245 non-null  uint8  
 51  day_of_week_thu                38245 non-null  uint8  
 52  day_of_week_tue                38245 non-null  uint8  
 53  day_of_week_wed                38245 non-null  uint8  
 54  poutcome_failure               38245 non-null  uint8  
 55  poutcome_nonexistent           38245 non-null  uint8  
 56  poutcome_success               38245 non-null  uint8  
dtypes: float64(10), uint8(47)
memory usage: 5.9 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="133">
<div class="sourceCode" id="cb213"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_with_dummies, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">48</span>)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>x_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="133">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>emp_var_rate</th>
      <th>cons_price_idx</th>
      <th>cons_conf_idx</th>
      <th>euribor3m</th>
      <th>nr_employed</th>
      <th>...</th>
      <th>month_oct</th>
      <th>month_sep</th>
      <th>day_of_week_fri</th>
      <th>day_of_week_mon</th>
      <th>day_of_week_thu</th>
      <th>day_of_week_tue</th>
      <th>day_of_week_wed</th>
      <th>poutcome_failure</th>
      <th>poutcome_nonexistent</th>
      <th>poutcome_success</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9324</th>
      <td>-0.763981</td>
      <td>-0.901529</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>1.552308</td>
      <td>-0.272290</td>
      <td>0.776615</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1859</th>
      <td>0.305085</td>
      <td>-0.416521</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.711883</td>
      <td>0.328423</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25960</th>
      <td>1.568527</td>
      <td>3.875420</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.116775</td>
      <td>-0.642504</td>
      <td>-0.315551</td>
      <td>0.287077</td>
      <td>0.395313</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>40182</th>
      <td>-1.249920</td>
      <td>-0.966967</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-1.138536</td>
      <td>1.118551</td>
      <td>0.052164</td>
      <td>-1.596517</td>
      <td>-2.450307</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28279</th>
      <td>-1.444296</td>
      <td>-0.620532</td>
      <td>-0.566106</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-1.202396</td>
      <td>-0.859383</td>
      <td>-1.418697</td>
      <td>-1.258984</td>
      <td>-0.952246</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25325</th>
      <td>0.207897</td>
      <td>1.261763</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-0.116775</td>
      <td>-0.642504</td>
      <td>-0.315551</td>
      <td>0.306150</td>
      <td>0.395313</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>32399</th>
      <td>1.374151</td>
      <td>-0.705216</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>-1.202396</td>
      <td>-1.175158</td>
      <td>-1.224024</td>
      <td>-1.335276</td>
      <td>-0.952246</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10444</th>
      <td>0.791024</td>
      <td>-0.535848</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>1.552308</td>
      <td>-0.272290</td>
      <td>0.772569</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>-0.861169</td>
      <td>-0.027744</td>
      <td>-0.204761</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.649546</td>
      <td>0.735109</td>
      <td>0.895747</td>
      <td>0.714195</td>
      <td>0.328423</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17288</th>
      <td>0.207897</td>
      <td>-0.508903</td>
      <td>0.156584</td>
      <td>0.192456</td>
      <td>-0.348978</td>
      <td>0.841126</td>
      <td>0.603247</td>
      <td>-0.466963</td>
      <td>0.773725</td>
      <td>0.845428</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>26771 rows × 57 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="134">
<div class="sourceCode" id="cb214"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="134">
<pre><code>KNeighborsClassifier(n_neighbors=3)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="135">
<div class="sourceCode" id="cb216"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(x_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="136">
<div class="sourceCode" id="cb217"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># accuracy</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="136">
<pre><code>0.894718493986404</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="137">
<div class="sourceCode" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Rate</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="137">
<pre><code>0.10528150601359598</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="138">
<div class="sourceCode" id="cb221"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="138">
<pre><code>0.5290519877675841</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="139">
<div class="sourceCode" id="cb223"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="139">
<pre><code>0.41027667984189725</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="140">
<div class="sourceCode" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F1 Score</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="140">
<pre><code>0.46215494211932323</code></pre>
</div>
</div>
</body>
</html>
